<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Stunning Wealth Intelligence</title>
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
<link rel="stylesheet" href="styles.css" />
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.umd.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3/dist/chartjs-adapter-date-fns.bundle.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-chart-financial@3.3.0/dist/chartjs-chart-financial.min.js" defer></script>
<script src="./config.sample.js" defer></script>
<script src="./config.local.js" defer></script>
<script src="./app.js" defer></script>
</head>
<body>
<button id="theme-toggle" class="theme-toggle" aria-label="Switch to light mode">
    <span class="theme-icon">&#9728;</span>
    <span class="sr-only">Toggle theme</span>
</button>

<button id="asset-view-toggle" type="button" class="floating-view-toggle" aria-label="Switch to plates view" title="Switch to plates view">
    <svg class="view-toggle-icon" width="22" height="22" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <rect x="3" y="3" width="7" height="7" rx="1.5"></rect>
        <rect x="14" y="3" width="7" height="7" rx="1.5"></rect>
        <rect x="3" y="14" width="7" height="7" rx="1.5"></rect>
        <rect x="14" y="14" width="7" height="7" rx="1.5"></rect>
    </svg>
    <span class="sr-only" id="asset-view-toggle-label">Switch to plates view</span>
</button>

<button id="pnl-percentage-toggle" type="button" class="floating-pnl-toggle" aria-label="Show P&amp;L percentages" title="Show P&amp;L percentages" aria-pressed="false">
    <span class="pnl-toggle-icon" aria-hidden="true">%</span>
    <span class="sr-only" id="pnl-percentage-toggle-label">Show P&amp;L percentages</span>
</button>

<div id="loading-overlay">
    <div class="spinner"></div>
    <div class="loading-text">Loading portfolio&hellip;</div>
</div>

<div class="wrap">
    <header>
        <div>
            <div class="pill">Realtime Wealth Overview &middot; <span>Connected</span></div>
            <h1>Wealth Intelligence Hub</h1>
            <p class="subtitle">Live holdings pulled directly from Airtable Operations and enriched with Finnhub market data. Track allocations, intraday moves, and long-term performance in one glass dashboard.</p>
        </div>
    </header>

    <div class="top-summary">
        <div class="kpi" id="pnl-card">
            <div class="label">Total P&amp;L</div>
            <div class="pnl-tabs" id="pnl-range-tabs" role="tablist" aria-label="P&amp;L ranges">
                <button type="button" class="pnl-tab" data-pnl-range="1D" role="tab" aria-selected="false" tabindex="-1">Daily PNL</button>
                <button type="button" class="pnl-tab" data-pnl-range="1W" role="tab" aria-selected="false" tabindex="-1">Weekly PNL</button>
                <button type="button" class="pnl-tab" data-pnl-range="1M" role="tab" aria-selected="false" tabindex="-1">Monthly PNL</button>
                <button type="button" class="pnl-tab" data-pnl-range="1Y" role="tab" aria-selected="false" tabindex="-1">Yearly PNL</button>
                <button type="button" class="pnl-tab" data-pnl-range="ALL" role="tab" aria-selected="false" tabindex="-1">All</button>
            </div>
             <div class="big" id="total-pnl">$0.00</div>
            <div class="pnl-breakdown">
                <div class="pnl-sub">
                    <span class="pnl-sub-label">Crypto</span>
                    <span class="pnl-sub-value" id="pnl-category-crypto">$0.00</span>
                </div>
                <div class="pnl-sub">
                    <span class="pnl-sub-label">Stocks</span>
                    <span class="pnl-sub-value" id="pnl-category-stock">$0.00</span>
                </div>
                <div class="pnl-sub">
                    <span class="pnl-sub-label">Real Estate</span>
                    <span class="pnl-sub-value" id="pnl-category-realestate">$0.00</span>
                </div>
            </div>
        </div>
        <div class="kpi" id="net-worth-card">
            <div class="label">Net Worth</div>
            <div class="big" id="equity">$0.00</div>
            <small class="networth-note unavailable" id="networth-million-note">1M target: —</small>
            <div class="networth-controls">
                <button id="networth-mindmap-button" type="button" class="networth-view-toggle" aria-controls="networth-bubble-container" aria-expanded="false" aria-pressed="false">
                    <span class="bubbles-icon" aria-hidden="true">
                        <span class="bubble-dot bubble-dot-main"></span>
                        <span class="bubble-dot bubble-dot-mid"></span>
                        <span class="bubble-dot bubble-dot-small"></span>
                    </span>
                    <span class="sr-only" id="networth-mindmap-button-label">Show bubbles</span>
                </button>
            </div>
            <div class="networth-chart">
                <canvas id="networth-sparkline"></canvas>
            </div>
            <div class="networth-bubble-container hidden" id="networth-bubble-container" aria-hidden="true">
                <div class="networth-mindmap" id="networth-mindmap">
                    <svg class="mindmap-links" id="networth-mindmap-links" role="presentation" aria-hidden="true"></svg>
                    <div class="mindmap-nodes" id="networth-mindmap-nodes"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="card full realestate-card">
        <div class="card-header-with-icon">
            <div class="card-heading">
                <span class="card-icon">
                    <img src="assets/real-estate.svg" alt="Real estate and automobile" loading="lazy" decoding="async" />
                </span>
                <div>
                    <strong>Rental and Automobile Portfolio Analytics</strong>
                    <div class="pos" style="margin-top:4px">Real estate and vehicle assets with recurring cashflow performance insight.</div>
                </div>
            </div>
            <div class="card-header-right">
                <div class="analytics-summary">
                    <div class="metric">
                            <span class="label">Value (projected)</span>
                        <span class="value" id="realestate-value">$0.00</span>
                    </div>
                    <div class="metric">
                        <span class="label">Allocation</span>
                        <span class="value" id="realestate-allocation">&mdash;</span>
                    </div>
                </div>
                <button type="button" class="card-info-button info-button" data-best-info-trigger="realEstate" aria-haspopup="dialog" aria-expanded="false">
                    <span class="info-icon" aria-hidden="true">i</span>
                    <span class="sr-only">Show real estate best performer</span>
                </button>
            </div>
        </div>
        <details class="analytics-section chart-section" id="realestate-history" data-chart="realestateRentChart">
            <summary>
                <div class="summary-left"><span class="summary-title">Rent history</span></div>
                <div class="summary-extra">Yearly totals</div>
            </summary>
            <div class="analytics-section-content">
                <div class="realestate-controls" id="realestate-rent-filters"></div>
                <div class="realestate-chart">
                    <canvas id="realestateRentChart"></canvas>
                </div>
            </div>
        </details>
        <div class="realestate-list" id="realestate-stats">
            <div class="pos">Loading rental analytics&hellip;</div>
        </div>
    </div>

    <div class="card full analytics-card crypto-card">
        <div class="analytics-header">
            <div>
                <strong>Crypto Portfolio Analytics</strong>
                <div class="pos" style="margin-top:4px">Live exposure, performance, and allocation across digital assets.</div>
            </div>
            <div class="analytics-header-right">
                <div class="analytics-summary">
                    <div class="metric">
                        <span class="label">Market Value</span>
                        <span class="value" id="crypto-market-value">$0.00</span>
                    </div>
                    <div class="metric">
                        <span class="label">Unrealized P&amp;L</span>
                        <span class="value" id="crypto-pnl">$0.00</span>
                    </div>
                    <div class="metric">
                        <span class="label">Portfolio Share</span>
                        <span class="value" id="crypto-allocation">?</span>
                    </div>
                </div>
                <button type="button" class="card-info-button info-button" data-best-info-trigger="crypto" aria-haspopup="dialog" aria-expanded="false">
                    <span class="info-icon" aria-hidden="true">i</span>
                    <span class="sr-only">Show crypto best performer</span>
                </button>
            </div>
        </div>
        <details class="analytics-section chart-section" data-chart="cryptoPortfolioChart">
            <summary>
                <div class="summary-left"><span class="summary-title">Allocation chart</span></div>
                <div class="summary-extra">Value distribution</div>
            </summary>
            <div class="analytics-section-content">
                <div class="analytics-chart">
                    <canvas id="cryptoPortfolioChart"></canvas>
                </div>
            </div>
        </details>
        <div class="analytics-list" id="crypto-positions">
            <div class="pos">Loading crypto analytics&hellip;</div>
        </div>
    </div>

    <div class="card full analytics-card stock-card">
        <div class="analytics-header">
            <div>
                <strong>Stocks Portfolio Analytics</strong>
                <div class="pos" style="margin-top:4px">Equity allocations, gains, and concentration across public markets.</div>
            </div>
            <div class="analytics-header-right">
                <div class="analytics-summary">
                    <div class="metric">
                        <span class="label">Market Value</span>
                        <span class="value" id="stock-market-value">$0.00</span>
                    </div>
                    <div class="metric">
                        <span class="label">Unrealized P&amp;L</span>
                        <span class="value" id="stock-pnl">$0.00</span>
                    </div>
                    <div class="metric">
                        <span class="label">Portfolio Share</span>
                        <span class="value" id="stock-allocation">?</span>
                    </div>
                </div>
                <div class="analytics-header-actions">
                    <div class="market-status" id="market-status">
                        <span class="market-dot" id="market-status-dot"></span>
                        <div class="market-status-text">
                            <span id="market-status-text">Checking market hours…</span>
                            <div class="market-hours">
                                <span id="market-hours-us"></span>
                                <span id="market-hours-local"></span>
                                <span id="market-next-open"></span>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="card-info-button info-button" data-best-info-trigger="stock" aria-haspopup="dialog" aria-expanded="false">
                        <span class="info-icon" aria-hidden="true">i</span>
                        <span class="sr-only">Show stock best performer</span>
                    </button>
                </div>
            </div>
        </div>
        <details class="analytics-section chart-section" data-chart="stockPortfolioChart">
            <summary>
                <div class="summary-left"><span class="summary-title">Allocation chart</span></div>
                <div class="summary-extra">Value distribution</div>
            </summary>
            <div class="analytics-section-content">
                <div class="analytics-chart">
                    <canvas id="stockPortfolioChart"></canvas>
                </div>
            </div>
        </details>
        <div class="analytics-list" id="stock-positions">
            <div class="pos">Loading stock analytics&hellip;</div>
        </div>
    </div>

    <footer>
        <div><span class="status-dot"></span><span id="status">&nbsp;</span></div>
        <div>Powered by Airtable &middot; Finnhub &middot; Chart.js</div>
    </footer>
</div>

<div id="networth-detail-modal" class="modal hidden" aria-hidden="true">
    <div class="modal-content networth-detail-content" role="dialog" aria-modal="true" aria-labelledby="networth-detail-title">
        <button type="button" class="modal-close" aria-label="Close net worth detail chart">&times;</button>
        <h3 class="modal-title" id="networth-detail-title">Net Worth Timeline</h3>
        <div class="modal-subtitle" id="networth-detail-subtitle"></div>
        <div class="modal-chart networth-detail-chart">
            <canvas id="networth-detail-chart"></canvas>
        </div>
        <div class="modal-meta" id="networth-detail-meta"></div>
    </div>
</div>

<div id="transaction-modal" class="modal hidden" aria-hidden="true">
    <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="transaction-modal-title">
        <button type="button" class="modal-close" aria-label="Close transactions chart">&times;</button>
        <h3 class="modal-title" id="transaction-modal-title">Asset transactions</h3>
        <div class="modal-subtitle" id="transaction-modal-subtitle"></div>
        <div class="modal-chart">
            <canvas id="transaction-chart"></canvas>
        </div>
        <div class="modal-meta" id="transaction-modal-meta"></div>
        <div class="modal-lots hidden" id="transaction-lots"></div>
        <div class="modal-toolbar modal-toolbar-bottom">
            <button type="button" id="view-lots-btn" class="btn btn-secondary">View lots</button>
        </div>
    </div>
</div>

<div id="best-info-popover" class="best-info-popover hidden" role="dialog" aria-modal="false" aria-labelledby="best-info-title">
    <div class="best-info-content" tabindex="-1">
        <div class="best-info-header">
            <div class="best-info-title-group">
                <span class="best-info-title" id="best-info-title">Best Performer</span>
                <span class="best-info-range" id="best-info-range"></span>
            </div>
            <span class="best-info-category" id="best-info-category"></span>
        </div>
        <div class="best-info-body">
            <div class="best-info-name" id="best-info-name">&mdash;</div>
            <div class="best-info-metrics">
                <span class="best-info-pnl" id="best-info-pnl">$0.00</span>
                <span class="best-info-change" id="best-info-change">&mdash;</span>
            </div>
            <div class="best-info-meta" id="best-info-meta">Awaiting data&hellip;</div>
            <div class="best-info-extra" id="best-info-extra"></div>
        </div>
    </div>
</div>
</body>
</html>
